var CategoryManage=function(){function l(){$(".btn-category-update").click(function(n){if(n.currentTarget.type==="button"&&typeof n.currentTarget.attributes["data-model"]!="undefined"){let t=n.currentTarget.attributes["data-model"].value,i=JSON.parse(t);a(i)}});$(".btn-category-add").click(function(){c()});$(".btn-category-delete").click(function(n){let i=this;if(n.currentTarget.type==="button"&&typeof n.currentTarget.attributes["data-id"]!="undefined"){let r=JSON.parse(n.currentTarget.attributes["data-delete"].value.toLocaleLowerCase()),u="This category will move to trash bin, you can recovery in future!",f=r?"Yes, delete it!":"Yes, let's move it!";r&&(u="This category will to permanently delete, you don't recovery in future!");t.fire({title:"Are you sure?",text:u,icon:"warning",showCancelButton:!0,customClass:{confirmButton:"btn btn-danger m-1",cancelButton:"btn btn-secondary m-1"},confirmButtonText:f,html:!1,preConfirm:()=>new Promise(n=>{setTimeout(()=>{n()},50)})}).then(u=>{if(u.value){let f=n.currentTarget.attributes["data-id"].value,e=$('input[name="__RequestVerificationToken"]').val(),u=new FormData;u.append("categoryId",f);u.append("isDelete",r);u.append("__RequestVerificationToken",e);$.ajax({url:"/api/manage/category",type:"DELETE",data:u,contentType:!1,processData:!1,success:function(n){if(typeof n!="undefined"&&n.successed&&n.data){$(i).closest("tr").slideUp(500);let n="This category has been moved to the trash!";r&&(n="The category was successfully deleted!");t.fire(r?"Deleted!":"Trash!",n,"success")}else t.fire("Oops...","Something went wrong!","error")},error:function(n){console.log(n);let i="Something went wrong!";typeof n.responseJSON!="undefined"&&n.responseJSON.message.length>0&&(i=n.responseJSON.message);t.fire("Warning",i,"warning")}})}})}});$(".btn-category-submit").click(function(){let u=$(i).val(),r=u.length>0?!0:!1,f=r?"/api/manage/category?id="+u:"/api/manage/category",e=$(n).find("form")[0],o=new FormData(e);$.ajax({url:f,type:r?"PUT":"POST",data:o,contentType:!1,processData:!1,"async":!1,success:function(n){if(n!=null&&typeof n!="undefined")if(n.responseCode==200&&n.successed==!0){let n="Everything was updated perfectly!";r||(n="Category added successfully!");t.fire("Success",n,"success");setTimeout(()=>{location.reload(!0),c()},1500)}else{let i="Something went wrong!";typeof n!="undefined"&&typeof n.message!="undefined"&&n.message.length>0&&(i=n.message);t.fire("Oops...",i,"error")}}})});$("#enable-url-edit").change(function(n){let t=$(n.currentTarget).prop("checked");r.prop("readonly",!t)})}function a(n){if(n==null||typeof n=="undefined")return!1;i.val(n.Id);u.val(n.Title);r.val(n.Url);f.val(n.Code);e.val(n.Position);o.val(n.Note);h.prop("checked",n.ShowOnTab);s.prop("checked",n.Publish)}function c(){i.val("");u.val("");r.val("");f.val("");e.val("0");o.val("");h.prop("checked",!1);s.prop("checked",!0)}const n=$("#modal-category .modal-body"),i=n.find("input[name=Id]"),u=n.find("#category-title"),r=n.find("#category-url"),f=n.find("#category-code"),e=n.find("#category-position"),o=n.find("#category-note"),s=n.find("#category-publish"),h=n.find("#category-showOnTab"),v=n.find(".btn-category-submit"),t=Swal.mixin({buttonsStyling:!1,target:"#page-container",customClass:{confirmButton:"btn btn-success m-1",cancelButton:"btn btn-danger m-1",input:"form-control"}});return{Init:function(){l()}}};(new CategoryManage).Init();